<html>
	<head>
		<title>John Paul Hayes II</title>
		<meta charset="UTF-8">
		<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"/>

		<link href="https://fonts.googleapis.com/css?family=Vollkorn" rel="stylesheet">
		<link rel="stylesheet" type="text/css" href="/index.css">
		<script src="/index.js"></script>
	</head>
	<body>
		<table id="banner"><tr><td>
			<div id="bannerleft">
				<div id="icon"><a href="/index.html"><img src="/favicon.ico"/></a></div>
				<div id="status">Welcome.</div>
			</div></td><td style="display:table-cell;vertical-align:middle;">
			<div id="bannerright">
				<div id="links">
					<a class="bannerlink" href="/software.html">Software Portfolio</a>|
					<a class="bannerlink" href="/hobbies.html">Hobbies</a>|
					<a class="bannerlink" href="/blog/">Blog</a>|
					<a class="bannerlink" href="/cms/">Manage</a>|
					<a class="bannerlink" href="/about.html">About</a>
				</div>
			</div></td></tr>
		</table>
		<div id="contentborder">
			<div id="content">
				<h2>Content Management</h2>
<div id="loggedInLinks">
<a href="/cms/account.html">Account</a> | 
<a href="/cms/threads.html">Threads</a> | 
<a id="logoutButton" href="#">Logout</a>
<br>
</div>
<div id="loggedOutLinks">
<a href="/cms/login.html">Login</a> | 
<a href="/cms/register.html">Register</a>
</div>
<hr>
<script>
	sub_scripts.push(function(){
		var status = document.getElementById("status");
	
		document.getElementById("logoutButton").onclick = function() {
			localStorage.removeItem(localStorageUsernameKey);
			localStorage.removeItem(localStorageTokenKey);
			window.location.href = "/cms/index.html";
		};
		
		var loggedInLinks = document.getElementById("loggedInLinks");
		var loggedOutLinks = document.getElementById("loggedOutLinks");

		if(localStorage.getItem(localStorageTokenKey) !== null &&
		localStorage.getItem(localStorageTokenKey) !== "undefined"){
			callAPI("POST", "/token", {"token": localStorage.getItem(localStorageTokenKey)}, function(response){
				if(typeof(response.error) === 'undefined'){
					if(!flashed){
						status.innerHTML = "Logged in as " + localStorage.getItem(localStorageUsernameKey);
					}
			
					loggedInLinks.style.display = "inline";
					loggedOutLinks.style.display = "none";
				}else{
					loggedInLinks.style.display = "none";
					loggedOutLinks.style.display = "inline";
			
					localStorage.removeItem(localStorageUsernameKey);
					localStorage.removeItem(localStorageTokenKey);
			
					redirect_flash("/cms/login.html", "Not logged in.");
				}
			});
		}else{
			if(!flashed){
				status.innerHTML = "Not logged in.";
			}
	
			loggedInLinks.style.display = "none";
			loggedOutLinks.style.display = "inline";
		}
	});
</script>
<label for="usernameField">Username: </label>
<input type="text" id="usernameField"/>
<br>
<br>
<label for="passwordField">Password: </label>
<input type="password" id="passwordField"/>
<br>
<br>
<label for="emailField">Email: </label>
<input type="email" id="emailField">
<br>
<br>
<label for="firstNameField">First Name: </label>
<input type="text" id="firstNameField"/>
<br>
<br>
<label for="lastNameField">Last Name: </label>
<input type="text" id="lastNameField"/>
<br>
<br>
<input id="registerButton" type="button" value="Register"/>
<br>
<script>
	sub_scripts.push(function(){
		var status = document.getElementById("status");
		
		document.getElementById("registerButton").onclick = function() {
			callAPI("POST", "/user", {"values":
			[document.getElementById("usernameField").value,
			document.getElementById("passwordField").value,
			"",
			"",
			document.getElementById("emailField").value,
			document.getElementById("firstNameField").value,
			document.getElementById("lastNameField").value]}, function(response){
				if(typeof(response.error) === 'undefined'){
					redirect_flash("/cms/login.html", "You signed up successfully!");
				}else{
					status.innerHTML = response.error;
				}
			});
		};
	});
</script>


			</div>
		</div>
	</body>
</html>
