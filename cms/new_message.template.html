<h2>New Message</h2>
<label for="messageTitleField">Title: </label>
<input type="text" id="messageTitleField"/>
<br>
<br>
<label for="messageContentField">Content:</label>
<br>
<textarea id="messageContentField" cols="80" rows="20"></textarea>
<br>
<br>
<input id="createMessageButton" type="button" value="Create"/>
<script>
	sub_scripts.push(function(){
		var status = document.getElementById("status");
		if(!("tid" in urlParams)){
			window.location.href = "/cms/threads.html";
		}
	
		document.getElementById("createMessageButton").onclick = function() {
			callAPI("POST", "/message", {"token": localStorage.getItem(localStorageTokenKey),
			"values": [urlParams["tid"], document.getElementById("messageTitleField").value, document.getElementById("messageContentField").value]}, function(response){
				if(typeof(response.error) === 'undefined'){
					redirect_flash("/cms/thread.html?id=" + urlParams["tid"], "Message created!");
				}else{
					status.innerHTML = response.error;
				}
			});
		};
	});
</script>
